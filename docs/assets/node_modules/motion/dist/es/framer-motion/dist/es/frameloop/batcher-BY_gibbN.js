import{stepsOrder as a}from"./order-Bp7phl0o.js";import{createRenderStep as F}from"./render-step-YSQghiHn.js";const M=40;function N(o,l){let r=!1,c=!0;const e={delta:0,timestamp:0,isProcessing:!1},i=()=>r=!0,n=a.reduce((s,t)=>(s[t]=F(i),s),{}),{read:m,resolveKeyframes:u,update:f,preRender:d,render:g,postRender:h}=n,p=()=>{const s=performance.now();r=!1,e.delta=c?1e3/60:Math.max(Math.min(s-e.timestamp,M),1),e.timestamp=s,e.isProcessing=!0,m.process(e),u.process(e),f.process(e),d.process(e),g.process(e),h.process(e),e.isProcessing=!1,r&&l&&(c=!1,o(p))},R=()=>{r=!0,c=!0,e.isProcessing||o(p)};return{schedule:a.reduce((s,t)=>{const x=n[t];return s[t]=(P,w=!1,E=!1)=>(r||R(),x.schedule(P,w,E)),s},{}),cancel:s=>{for(let t=0;t<a.length;t++)n[a[t]].cancel(s)},state:e,steps:n}}export{N as createRenderBatcher};
