import{abs as j,epsilon as k}from"../math-yk45OU_y.js";import W from"./buffer-CTnDsoDH.js";import X from"./line-BxBv-4Ur.js";import Y from"./rejoin-CT8iLBb-.js";import Z from"../../../d3-array/src/merge-B2F1fGzm.js";var P=1e9,R=-1e9;function tn(c,M,_,p){function q(i,n){return c<=i&&i<=_&&M<=n&&n<=p}function z(i,n,l,f){var o=0,s=0;if(i==null||(o=d(i,l))!==(s=d(n,l))||A(i,n)<0^l>0)do f.point(o===0||o===3?c:_,o>1?p:M);while((o=(o+l+4)%4)!==s);else f.point(n[0],n[1])}function d(i,n){return j(i[0]-c)<k?n>0?0:3:j(i[0]-_)<k?n>0?2:1:j(i[1]-M)<k?n>0?1:0:n>0?3:2}function J(i,n){return A(i.x,n.x)}function A(i,n){var l=d(i,1),f=d(n,1);return l!==f?l-f:l===0?n[1]-i[1]:l===1?i[0]-n[0]:l===2?i[1]-n[1]:n[0]-i[0]}return function(i){var n=i,l=W(),f,o,s,C,D,F,E,I,v,B,w,L={point:G,lineStart:T,lineEnd:U,polygonStart:O,polygonEnd:Q};function G(t,e){q(t,e)&&n.point(t,e)}function K(){for(var t=0,e=0,r=o.length;e<r;++e)for(var u=o[e],a=1,V=u.length,g=u[0],S,h,N=g[0],m=g[1];a<V;++a)S=N,h=m,g=u[a],N=g[0],m=g[1],h<=p?m>p&&(N-S)*(p-h)>(m-h)*(c-S)&&++t:m<=p&&(N-S)*(p-h)<(m-h)*(c-S)&&--t;return t}function O(){n=l,f=[],o=[],w=!0}function Q(){var t=K(),e=w&&t,r=(f=Z(f)).length;(e||r)&&(i.polygonStart(),e&&(i.lineStart(),z(null,null,1,i),i.lineEnd()),r&&Y(f,J,t,z,i),i.polygonEnd()),n=i,f=o=s=null}function T(){L.point=H,o&&o.push(s=[]),B=!0,v=!1,E=I=NaN}function U(){f&&(H(C,D),F&&v&&l.rejoin(),f.push(l.result())),L.point=G,v&&n.lineEnd()}function H(t,e){var r=q(t,e);if(o&&s.push([t,e]),B)C=t,D=e,F=r,B=!1,r&&(n.lineStart(),n.point(t,e));else if(r&&v)n.point(t,e);else{var u=[E=Math.max(R,Math.min(P,E)),I=Math.max(R,Math.min(P,I))],a=[t=Math.max(R,Math.min(P,t)),e=Math.max(R,Math.min(P,e))];X(u,a,c,M,_,p)?(v||(n.lineStart(),n.point(u[0],u[1])),n.point(a[0],a[1]),r||n.lineEnd(),w=!1):r&&(n.lineStart(),n.point(t,e),w=!1)}E=t,I=e,v=r}return L}}export{tn as default};
