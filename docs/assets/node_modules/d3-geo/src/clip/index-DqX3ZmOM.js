import w from"./buffer-CTnDsoDH.js";import z from"./rejoin-CT8iLBb-.js";import{halfPi as c,epsilon as R}from"../math-yk45OU_y.js";import A from"../polygonContains-OPvjsdGS.js";import D from"../../../d3-array/src/merge-B2F1fGzm.js";function N(r,l,S,j){return function(n){var d=l(n),y=w(),u=l(y),e=!1,g,f,p,i={point:m,lineStart:h,lineEnd:v,polygonStart:function(){i.point=s,i.lineStart=P,i.lineEnd=q,f=[],g=[]},polygonEnd:function(){i.point=m,i.lineStart=h,i.lineEnd=v,f=D(f);var o=A(g,j);f.length?(e||(n.polygonStart(),e=!0),z(f,G,o,S,n)):o&&(e||(n.polygonStart(),e=!0),n.lineStart(),S(null,null,1,n),n.lineEnd()),e&&(n.polygonEnd(),e=!1),f=g=null},sphere:function(){n.polygonStart(),n.lineStart(),S(null,null,1,n),n.lineEnd(),n.polygonEnd()}};function m(o,t){r(o,t)&&n.point(o,t)}function C(o,t){d.point(o,t)}function h(){i.point=C,d.lineStart()}function v(){i.point=m,d.lineEnd()}function s(o,t){p.push([o,t]),u.point(o,t)}function P(){u.lineStart(),p=[]}function q(){s(p[0][0],p[0][1]),u.lineEnd();var o=u.clean(),t=y.result(),a,x=t.length,B,E,I;if(p.pop(),g.push(p),p=null,!!x){if(o&1){if(E=t[0],(B=E.length-1)>0){for(e||(n.polygonStart(),e=!0),n.lineStart(),a=0;a<B;++a)n.point((I=E[a])[0],I[1]);n.lineEnd()}return}x>1&&o&2&&t.push(t.pop().concat(t.shift())),f.push(t.filter(F))}}return i}}function F(r){return r.length>1}function G(r,l){return((r=r.x)[0]<0?r[1]-c-R:c-r[1])-((l=l.x)[0]<0?l[1]-c-R:c-l[1])}export{N as default};
