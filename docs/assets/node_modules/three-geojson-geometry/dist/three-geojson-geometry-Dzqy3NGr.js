import"../../three/build/three.module-DDr6UARD.js";import{flatten as V}from"../../earcut/src/earcut-BgfHUvkn.js";import{BufferGeometry as X,Float32BufferAttribute as Y}from"../../three/build/three.core-BhFki44V.js";import Z from"../../d3-geo/src/distance-BiWJ7apk.js";import x from"../../d3-geo/src/interpolate-CWAikPKj.js";import ee from"../../d3-interpolate/src/number-b8OrTc_-.js";function I(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function te(e){if(Array.isArray(e))return e}function re(e){if(Array.isArray(e))return I(e)}function ne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oe(e,t,r){return t=j(t),ve(e,J()?Reflect.construct(t,[],j(e).constructor):t.apply(e,r))}function ie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ae(e,t,r){return Object.defineProperty(e,"prototype",{writable:!1}),e}function ue(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=R(e))||t){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(i){throw i},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var u,h=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var i=r.next();return h=i.done,i},e:function(i){c=!0,u=i},f:function(){try{h||r.return==null||r.return()}finally{if(c)throw u}}}}function j(e){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},j(e)}function ce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&B(e,t)}function J(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(J=function(){return!!e})()}function fe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function se(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,u,h,c=[],i=!0,b=!1;try{if(u=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;i=!1}else for(;!(i=(n=u.call(r)).done)&&(c.push(n.value),c.length!==t);i=!0);}catch(g){b=!0,o=g}finally{try{if(!i&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(b)throw o}}return c}}function le(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ve(e,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ne(e)}function B(e,t){return B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},B(e,t)}function M(e,t){return te(e)||se(e,t)||R(e,t)||le()}function he(e){return re(e)||fe(e)||R(e)||pe()}function R(e,t){if(e){if(typeof e=="string")return I(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?I(e,t):void 0}}var $=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=[],o=null;return t.forEach(function(u){if(o){var h=Z(u,o)*180/Math.PI;if(h>r)for(var c=x(o,u),i=o.length>2||u.length>2?ee(o[2]||0,u[2]||0):null,b=i?function(A){return[].concat(he(c(A)),[i(A)])}:c,g=1/Math.ceil(h/r),w=g;w<1;)n.push(b(w)),w+=g}n.push(o=u)}),n},L=typeof window<"u"&&window.THREE?window.THREE:{BufferGeometry:X,Float32BufferAttribute:Y},ye=new L.BufferGeometry().setAttribute?"setAttribute":"addAttribute",Ae=function(e){function t(r){var n,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:5;ie(this,t),n=oe(this,t),n.type="GeoJsonGeometry",n.parameters={geoJson:r,radius:o,resolution:u};var h=({Point:g,MultiPoint:w,LineString:A,MultiLineString:N,Polygon:H,MultiPolygon:W}[r.type]||function(){return[]})(r.coordinates,o),c=[],i=[],b=0;h.forEach(function(f){var s=c.length;E({indices:c,vertices:i},f),n.addGroup(s,c.length-s,b++)}),c.length&&n.setIndex(c),i.length&&n[ye]("position",new L.Float32BufferAttribute(i,3));function g(f,s){var l=G(f[1],f[0],s+(f[2]||0)),a=[];return[{vertices:l,indices:a}]}function w(f,s){var l={vertices:[],indices:[]};return f.map(function(a){return g(a,s)}).forEach(function(a){var p=M(a,1),v=p[0];E(l,v)}),[l]}function A(f,s){for(var l=$(f,u).map(function(_){var P=M(_,3),T=P[0],S=P[1],O=P[2],d=O===void 0?0:O;return G(S,T,s+d)}),a=V([l]),p=a.vertices,v=Math.round(p.length/3),y=[],m=1;m<v;m++)y.push(m-1,m);return[{vertices:p,indices:y}]}function N(f,s){var l={vertices:[],indices:[]};return f.map(function(a){return A(a,s)}).forEach(function(a){var p=M(a,1),v=p[0];E(l,v)}),[l]}function H(f,s){for(var l=f.map(function(z){return $(z,u).map(function(U){var C=M(U,3),q=C[0],K=C[1],D=C[2],Q=D===void 0?0:D;return G(K,q,s+Q)})}),a=V(l),p=a.vertices,v=a.holes,y=v[0]||1/0,m=p.slice(0,y*3),_=p.slice(y*3),P=new Set(v),T=Math.round(p.length/3),S=[],O=[],d=1;d<T;d++)P.has(d)||(d<y?S.push(d-1,d):O.push(d-1-y,d-y));var F=[{indices:S,vertices:m}];return v.length&&F.push({indices:O,vertices:_}),F}function W(f,s){var l={vertices:[],indices:[]},a={vertices:[],indices:[]};f.map(function(v){return H(v,s)}).forEach(function(v){var y=M(v,2),m=y[0],_=y[1];E(l,m),_&&E(a,_)});var p=[l];return a.vertices.length&&p.push(a),p}return n}return ce(t,e),ae(t)}(L.BufferGeometry);function E(e,t){var r=Math.round(e.vertices.length/3);k(e.vertices,t.vertices),k(e.indices,t.indices.map(function(n){return n+r}))}function k(e,t){var r=ue(t),n;try{for(r.s();!(n=r.n()).done;){var o=n.value;e.push(o)}}catch(u){r.e(u)}finally{r.f()}}function G(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=(90-e)*Math.PI/180,o=(90-t)*Math.PI/180;return[r*Math.sin(n)*Math.cos(o),r*Math.cos(n),r*Math.sin(n)*Math.sin(o)]}export{Ae as default};
